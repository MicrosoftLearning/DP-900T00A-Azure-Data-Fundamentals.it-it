---
ms.openlocfilehash: 34b661fbb1237d51bdab932626d19518225841a0
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 02/05/2022
ms.locfileid: "138051956"
---
<a name="are-we-there-yet"></a>are-we-there-yet
----------------

Tenere traccia di gerarchie complesse degli stati di completamento delle attività asincrone.  È progettato per offrire un modo per registrare e segnalare lo stato di avanzamento del fan-out ricorsivo e raccogliere flussi di lavoro relativi al tipo, molto comuni nei programmi asincroni.

Le operazioni eseguite con questi dati di completamento dipendono dall'utente, ma il caso d'uso più comune consiste nell'inserire i dati in uno dei numerosi moduli di un indicatore di stato.

La maggior parte dei moduli di un indicatore di stato include una versione rudimentale di questa funzionalità, ma le esigenze erano più complesse.

<a name="usage"></a>Utilizzo
=====

```javascript
var TrackerGroup = require("are-we-there-yet").TrackerGroup

var top = new TrackerGroup("program")

var single = top.newItem("one thing", 100)
single.completeWork(20)

console.log(top.completed()) // 0.2

fs.stat("file", function(er, stat) {
  if (er) throw er  
  var stream = top.newStream("file", stat.size)
  console.log(top.completed()) // now 0.1 as single is 50% of the job and is 20% complete
                              // and 50% * 20% == 10%
  fs.createReadStream("file").pipe(stream).on("data", function (chunk) {
    // do stuff with chunk
  })
  top.on("change", function (name) {
    // called each time a chunk is read from "file"
    // top.completed() will start at 0.1 and fill up to 0.6 as the file is read
  })
})
```

<a name="shared-methods"></a>Metodi condivisi
==============

* var completed = tracker.completed()

Implementato in: `Tracker`, `TrackerGroup`, `TrackerStream`

Restituisce il rapporto tra lavoro completato e lavoro da eseguire. Intervallo compreso tra 0 e 1.

* tracker.finish()

Implementato in: `Tracker`, `TrackerGroup`

Contrassegna il tracker come completato. Con TrackerGroup, contrassegna tutti i relativi componenti come completati.

Contrassegna tutti i componenti di questo tracker come completati, il che significa che `tracker.completed()` per questo elemento ora sarà 1.

Ciò comporterà la generazione di uno o più eventi `change`.

<a name="events"></a>evento
======

Tutti gli oggetti tracker generano eventi `change` con gli argomenti seguenti:

```
function (name, completed, tracker)
```

`name` è il nome del tracker che ha originariamente generato l'evento oppure, se non ne aveva uno, il primo gruppo di tracker che ne aveva uno.

`completed` è la percentuale di completamento (come restituita dal metodo `tracker.completed()`).

`tracker` è l'oggetto tracker su cui si è in ascolto degli eventi.

<a name="trackergroup"></a>TrackerGroup
============

* var tracker = new TrackerGroup(**name**)

  * **name** *(facoltativo):* nome del gruppo di tracker, usato nelle notifiche di modifica se l'aggiornamento del componente non aveva un nome. Il valore predefinito non è definito.

Crea un nuovo gruppo di aggregazioni di tracker vuoto. Si tratta di tracker il cui stato di completamento è determinato dallo stato di completamento di altri tracker.

* tracker.addUnit(**otherTracker**, **weight**)

  * **otherTracker**: qualsiasi altro oggetto tracker are-we-there-yet
  * **weight** *(facoltativo)* : peso da attribuire al tracker, il valore predefinito è 1.

Aggiunge **otherTracker** a questo gruppo di aggregazioni. Il peso determina il tempo previsto per il completamento di questo tracker in proporzione ad altre unità.  Ad esempio, se si aggiunge un tracker con un peso pari a 1 e un altro con un peso pari a 2, il secondo richiederà il doppio del tempo per il completamento rispetto al primo.  Di conseguenza, il primo rappresenterà il 33% del completamento di questo tracker e il secondo corrisponderà al restante 67%.

Restituisce **otherTracker**.

* var subGroup = tracker.newGroup(**name**, **weight**)

L'espressione precedente equivale esattamente a:

```javascript
  var subGroup = tracker.addUnit(new TrackerGroup(name), weight)
```

* var subItem = tracker.newItem(**name**, **todo**, **weight**)

L'espressione precedente equivale esattamente a:

```javascript
  var subItem = tracker.addUnit(new Tracker(name, todo), weight)
```

* var subStream = tracker.newStream(**name**, **todo**, **weight**)

L'espressione precedente equivale esattamente a:

```javascript
  var subStream = tracker.addUnit(new TrackerStream(name, todo), weight)
```

* console.log( tracker.debug() )

Restituisce un albero che mostra il completamento di questo gruppo di tracker e di tutti i relativi elementi figlio, inclusa l'immissione ricorsiva di tutti gli elementi figlio.

<a name="tracker"></a>Tracker
=======

* var tracker = new Tracker(**name**, **todo**)

  * **name** *(facoltativo)* Nome del contatore da segnalare negli eventi di modifica.  Il valore predefinito non è definito.
  * **todo** *(facoltativo)* Quantità di lavoro da eseguire (numero). Il valore predefinito è 0.

In genere, sono costruiti come parte di un gruppo di tracker (tramite `newItem`).

* var completed = tracker.completed()

Restituisce il rapporto tra lavoro completato e lavoro da eseguire. Intervallo compreso tra 0 e 1. Se il lavoro totale da eseguire è 0, restituirà 0.

* tracker.addWork(**todo**)

  * **todo** Numero da aggiungere alla quantità di lavoro da eseguire.

Aumenta la quantità di lavoro da eseguire, riducendo la percentuale di completamento.  Attiva un evento `change`.

* tracker.completeWork(**completed**)

  * **completed** Numero da aggiungere al lavoro completato

Aumenta la quantità di lavoro completata, incrementando la percentuale di completamento.
Non aumenta mai il lavoro completato oltre la quantità di lavoro da eseguire. In altri termini, le percentuali superiori al 100% non sono consentite. Attiva un evento `change`.

* tracker.finish()

Contrassegna questo tracker come completato, tracker.completed() ora sarà 1. Attiva un evento `change`.

<a name="trackerstream"></a>TrackerStream
=============

* var tracker = new TrackerStream(**name**, **size**, **options**)

  * **name** *(facoltativo)* Nome del contatore da segnalare negli eventi di modifica.  Il valore predefinito non è definito.
  * **size** *(facoltativo)* Numero di byte inviati tramite questo flusso.
  * **options** *(facoltativo)* Hash delle opzioni di flusso

L'oggetto flusso tracker è un flusso pass-through che aggiorna un oggetto tracker interno ogni volta che viene passato un blocco.  È progettato per tenere traccia di download, estrazione di file e altre attività correlate. È possibile usarlo eseguendo il pipe dell'origine dati e quindi usandolo come origine dati.

Se i dati hanno un attributo di lunghezza, questo viene usato come quantità di lavoro completato al passaggio del blocco.  In caso contrario (ad esempio, flussi di oggetti), ogni blocco viene conteggiato come completamento di 1 unità di lavoro, quindi le dimensioni devono essere il numero totale di oggetti inviati nel flusso.

* tracker.addWork(**todo**)

  * **todo** Aumentare le dimensioni complessive previste dei byte **todo**.

Aumenta la quantità di lavoro da eseguire, riducendo la percentuale di completamento.  Attiva un evento `change`.
