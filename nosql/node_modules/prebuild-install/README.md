---
ms.openlocfilehash: 50690c00791b1f6ca1d585c1fb653f0ec4794578
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 02/05/2022
ms.locfileid: "138051707"
---
# <a name="prebuild-install"></a>prebuild-install

> **Strumento della riga di comando per installare facilmente file binari predefiniti per più versioni di Node.js ed Electron in una piattaforma specifica.**
> Per impostazione predefinita, scarica i file binari predefiniti da una versione GitHub.

[![npm](https://img.shields.io/npm/v/prebuild-install.svg)](https://www.npmjs.com/package/prebuild-install)
![Versione di Node](https://img.shields.io/node/v/prebuild-install.svg)
[![Test](https://github.com/prebuild/prebuild-install/actions/workflows/test.yml/badge.svg)](https://github.com/prebuild/prebuild-install/actions/workflows/test.yml)
[![david](https://david-dm.org/prebuild/prebuild-install.svg)](https://david-dm.org/prebuild/prebuild-install)
[![js-standard-style](https://img.shields.io/badge/code%20style-standard-brightgreen.svg)](http://standardjs.com/)

## <a name="note"></a>Nota

**Invece di [`prebuild`](https://github.com/prebuild/prebuild) associato a [`prebuild-install`](https://github.com/prebuild/prebuild-install), consigliamo [`prebuildify`](https://github.com/prebuild/prebuildify) associato a [`node-gyp-build`](https://github.com/prebuild/node-gyp-build).**

Con `prebuildify`, tutti i file binari predefiniti vengono inclusi all'interno del pacchetto pubblicato in npm, il che significa che non è necessario un passaggio di download separato, come nel caso di `prebuild`. L'ironia di questo approccio è che è più veloce scaricare tutti i file binari predefiniti per ogni piattaforma quando vengono raggruppati in un pacchetto, rispetto al download di un singolo file binario predefinito come script di installazione.

Aspetti positivi:

1. Nessun passaggio di download aggiuntivo, rendendo più affidabile e veloce l'installazione.
2. Supporto della modifica delle versioni di runtime in locale e l'uso della stessa installazione per Node.js e Electron. La reinstallazione o la ricompilazione non è necessaria, poiché tutti i file binari predefiniti si trovano nel tarball npm e quello corretto viene semplicemente prelevato in fase di esecuzione.
3. La dipendenza di runtime `node-gyp-build` è libera da dipendenze e rimarrà tale per principio, perché l'introduzione delle dipendenze sarebbe in contraddizione con il tempo di installazione più breve.
4. I file binari predefiniti funzionano anche se gli script di installazione npm sono disabilitati.
5. Il checksum del pacchetto npm copre anche i file binari predefiniti.

Aspetti negativi:

1. Il pacchetto npm installato è più grande su disco. L'uso di [Node-API](https://nodejs.org/api/n-api.html) risolve in parte questo problema perché i file binari di Node-API sono indipendenti dal runtime e compatibili con le versioni successive.
2. La pubblicazione è leggermente più complessa, perché l'esecuzione di `npm publish` deve avvenire dopo la compilazione e il recupero dei file binari predefiniti (in genere in CI).

## <a name="usage"></a>Utilizzo

Usare [`prebuild`](https://github.com/prebuild/prebuild) per creare e caricare file binari predefiniti. Modificare quindi lo script di installazione package.json come segue:

```json
{
  "scripts": {
    "install": "prebuild-install || node-gyp rebuild"
  }
}
```

### <a name="help"></a>Help

```
prebuild-install [options]

  --download    -d  [url]       (download prebuilds, no url means github)
  --target      -t  version     (version to install for)
  --runtime     -r  runtime     (Node runtime [node, napi or electron] to build or install for, default is node)
  --path        -p  path        (make a prebuild-install here)
  --token       -T  gh-token    (github token for private repos)
  --arch            arch        (target CPU architecture, see Node OS module docs, default is current arch)
  --platform        platform    (target platform, see Node OS module docs, default is current platform)
  --tag-prefix <prefix>         (github tag prefix, default is "v")
  --build-from-source           (skip prebuild download)
  --verbose                     (log verbosely)
  --libc                        (use provided libc rather than system default)
  --debug                       (set Debug or Release configuration)
  --version                     (print prebuild-install version and exit)
```

Quando si esegue `prebuild-install` tramite uno script `npm`, è possibile eseguire il pass-through delle opzioni `--build-from-source`, `--debug`, `--download`, `--target`, `--runtime`, `--arch` e `--platform` tramite argomenti passati al comando `npm`.

In alternativa, è possibile impostare le variabili di ambiente `npm_config_build_from_source=true`, `npm_config_platform`, `npm_config_arch`, `npm_config_target` e `npm_config_runtime`.

### <a name="private-repositories"></a>Repository privati

`prebuild-install` supporta il download di precompilazioni dai repository privati GitHub tramite `-T <github-token>`:

```
$ prebuild-install -T <github-token>
```

Se non si vuole usare il token nell'interfaccia della riga di comando, è possibile inserirlo in `~/.prebuild-installrc`:

```
token=<github-token>
```

In alternativa, è possibile specificarlo nella variabile di ambiente `prebuild-install_token`.

Si noti che l'uso di un token di GitHub prevede l'uso dell'API per risolvere la release corretta e questo significa essere soggetti al limite di frequenza di GitHub ([GitHub Rate Limit](https://developer.github.com/v3/rate_limit/)).

### <a name="create-github-token"></a>Creare un token GitHub

Per creare un token:

- Passare a [questa pagina](https://github.com/settings/tokens)
- Fare clic sul pulsante `Generate new token`
- Assegnare al token un nome e fare clic sul pulsante `Generate token` (vedere di seguito)

![prebuild-token](https://cloud.githubusercontent.com/assets/13285808/20844584/d0b85268-b8c0-11e6-8b08-2b19522165a9.png)

Gli ambiti predefiniti dovrebbero essere appropriati.

### <a name="custom-binaries"></a>File binari personalizzati

L'utente finale può eseguire l'override del percorso di download binario tramite variabili di ambiente nel file con estensione npmrc.
La variabile deve soddisfare la maschera `% your package name %_binary_host` o `% your package name %_binary_host_mirror`. Esempio:

```
leveldown_binary_host=http://overriden-host.com/overriden-path
```

Si noti che il sottopercorso della versione del pacchetto e il nome del file verranno comunque aggiunti.
Quindi, se si installa `leveldown@1.2.3` l'URL risultante sarà:

```
http://overriden-host.com/overriden-path/v1.2.3/leveldown-v1.2.3-node-v57-win32-x64.tar.gz
```

#### <a name="local-prebuilds"></a>Precompilazioni locali

Se si vogliono usare le precompilazioni dal file system locale, è possibile usare la variabile .npmrc `% your package name %_local_prebuilds` per impostare un percorso sulla cartella contenente le precompilazioni. Esempio:

```
leveldown_local_prebuilds=/path/to/prebuilds
```

Questa opzione verrà visualizzata direttamente in tale cartella per i bundle creati con `prebuild`, ad esempio:

```
/path/to/prebuilds/leveldown-v1.2.3-node-v57-win32-x64.tar.gz
```

I percorsi non assoluti vengono risolti in riferimento alla directory del pacchetto che richiama prebuild-install, ad esempio per le dipendenze annidate.

### <a name="cache"></a>Cache

Tutti i file binari predefiniti vengono memorizzati nella cache per ridurre al minimo il traffico. Quindi, `prebuild-install` seleziona prima di tutto i file binari dalla cache e se non è possibile trovare alcun file binario, verranno scaricati. A seconda dell'ambiente, la cartella della cache viene determinata nell'ordine seguente:

- `${npm_config_cache}/_prebuilds`
- `${APP_DATA}/npm-cache/_prebuilds`
- `${HOME}/.npm/_prebuilds`

## <a name="license"></a>Licenza

MIT
