---
ms.openlocfilehash: 4f36d4681facd228c63b48050973040e9785d30f
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 02/05/2022
ms.locfileid: "138051227"
---

<a name="microsoft-authentication-library-for-javascript-msaljs"></a>Microsoft Authentication Library per JavaScript (MSAL.js)
=========================================================

| [Per iniziare](https://docs.microsoft.com/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa)| [Documentazione di AAD](https://aka.ms/aaddevv2) | [Riferimenti della libreria](https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal.html) | [Supporto](README.md#community-help-and-support) | [Esempi](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/Samples)
| --- | --- | --- | --- | --- |

⚠️⚠️⚠️ Questa libreria non riceve più nuove funzionalità e riceverà solo correzioni di bug e sicurezza critiche. Tutte le nuove applicazioni devono usare [@azure/msal-browser](https://www.npmjs.com/package/@azure/msal-browser) in alternativa. ⚠️⚠️⚠️

MSAL per JavaScript consente alle applicazioni Web JavaScript lato client, in esecuzione in un Web browser, di autenticare gli utenti usando account aziendali e dell'istituto di istruzione di [Azure AD](https://docs.microsoft.com/azure/active-directory/develop/v2-overview) (AAD), account personali Microsoft (MSA) e provider di identità social come Facebook, Google, LinkedIn, account Microsoft e così via tramite il servizio [Azure AD B2C](https://docs.microsoft.com/azure/active-directory-b2c/active-directory-b2c-overview#identity-providers). Consente anche all'app di ottenere i token per accedere ai servizi [Microsoft Cloud](https://www.microsoft.com/enterprise), ad esempio [Microsoft Graph](https://graph.microsoft.io).

[![versione npm](https://img.shields.io/npm/v/msal.svg?style=flat)](https://www.npmjs.com/package/msal)
[![versione npm](https://img.shields.io/npm/dm/msal.svg)](https://nodei.co/npm/msal/)
[![codecov](https://codecov.io/gh/AzureAD/microsoft-authentication-library-for-js/branch/dev/graph/badge.svg?flag=msal-core)](https://codecov.io/gh/AzureAD/microsoft-authentication-library-for-js)

## <a name="installation"></a>Installazione

### <a name="via-npm"></a>Tramite npm:

    npm install msal

## <a name="via-cdn"></a>Tramite rete CDN:

<!-- CDN_LATEST -->
```html
<script type="text/javascript" src="https://alcdn.msauth.net/lib/1.4.11/js/msal.min.js"></script>
```

I [dettagli completi e le procedure consigliate](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-core/docs/cdn.md) per l'utilizzo di una rete CDN sono disponibili nella documentazione.

## <a name="what-to-expect-from-this-library"></a>Cosa aspettarsi da questa libreria
Il supporto per MSAL in Javascript è una raccolta di librerie. `msal-core` o semplicemente `msal`, è la libreria core indipendente dal framework. Dopo la stabilizzazione della versione core 1.x+, forniremo la libreria `msal-angular` con i miglioramenti più recenti della versione 1.x.  Si prevede che il supporto di `msal-angularjs` verrà deprecato se le tendenze di utilizzo del framework e della libreria indicheranno un aumento dell'adozione di Angular 2+ anziché Angular 1x. Quando le nostre librerie correnti saranno conformi agli standard, inizieremo a bilanciare le nuove richieste di funzionalità con le nuove piattaforme come `react` e `node.js`.

Il nostro obiettivo è comunicare molto bene con la community e tenere conto delle opinioni di tutti. Vorremmo arrivare a una pianificazione di rilascio di versioni secondarie mensile, con la pubblicazione di patch con la frequenza necessaria.  Il livello di comunicazione, pianificazione e granularità che vogliamo ottenere sarà un lavoro in corso.

Controllare la [roadmap](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki#roadmap) per vedere su cosa stiamo lavorando e quali sono i prossimi interventi previsti.

## <a name="oauth-20-and-the-implicit-flow"></a>OAuth 2.0 e il flusso implicito

MSAL implementa il [flusso di concessione implicito](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-implicit-grant-flow), come definito dal protocollo OAuth 2.0 ed è conforme a [OpenID](https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc).

L'obiettivo è che la libreria offra un'astrazione del protocollo sufficiente, in modo che sia possibile ottenere l'autenticazione plug-and-play, ma è importante conoscere e comprendere il flusso implicito dal punto di vista della sicurezza.
Il flusso implicito viene eseguito nel contesto di un Web browser che non può gestire in modo sicuro i segreti client. È ottimizzato per le app a pagina singola e prevede un hop in meno tra client e server in modo che i token vengano restituiti direttamente al browser. Questi aspetti lo rendono naturalmente meno sicuro.
Questi problemi di sicurezza sono ridotti grazie a procedure standard, ad esempio l'uso di token di breve durata (e quindi non vengono restituiti token di aggiornamento), la libreria che richiede un URI di reindirizzamento registrato per l'app, la libreria che corrisponde alla richiesta e alla risposta con un parametro univoco nonce e di stato.

## <a name="cache-storage"></a>Archiviazione cache

Sono disponibili due metodi di archiviazione per MSAL: `localStorage` e `sessionStorage`.  Raccomandiamo di usare `sessionStorage` perché è più sicuro per l'archiviazione dei token acquisiti dagli utenti, ma `localStorage` offre l'accesso Single Sign-On tra schede e sessioni utente.  Si consiglia di esplorare le varie opzioni e prendere la decisione migliore per ogni applicazione.

### <a name="forcerefresh-to-skip-cache"></a>forceRefresh per ignorare la cache
Se si vuole ignorare un token memorizzato nella cache e passare al server, passare il parametro booleano `forceRefresh` nell'oggetto `AuthenticationParameters` usato per effettuare una richiesta di accesso/token. **AVVISO:** questa tecnica non deve essere usata per impostazione predefinita, a causa dell'impatto sulle prestazioni dell'applicazione.  L'uso della cache offre agli utenti un'esperienza migliore ed è consigliabile ignorarla solo in scenari in cui si sa che i dati memorizzati nella cache correnti non includono informazioni aggiornate.  Esempio: strumento di amministrazione per aggiungere ruoli a un utente che deve ottenere un nuovo token con i ruoli aggiornati.

## <a name="usage"></a>Utilizzo
L'esempio seguente illustra come gestire l'accesso di un utente e acquisire un token da usare per l'API Graph di Microsoft.

#### <a name="prerequisites"></a>Prerequisiti

Prima di usare MSAL.js sarà necessario [registrare un'applicazione in Azure AD](https://docs.microsoft.com/azure/active-directory/develop/quickstart-register-app) per ottenere un `clientId` valido per la configurazione e registrare le route su cui l'app accetterà il traffico di reindirizzamento.

#### <a name="1-instantiate-the-useragentapplication"></a>1. Creare un'istanza di UserAgentApplication

È possibile configurare `UserAgentApplication` con un'ampia gamma di opzioni diverse, descritte in dettaglio nel nostro [wiki](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL.js-1.0.0-api-release#configuration-options), ma l'unico parametro obbligatorio è `auth.clientId`.

Dopo aver creato l'istanza, se si prevede di usare un flusso di reindirizzamento in MSAL 1.2.x o versioni precedenti (`loginRedirect` e `acquireTokenRedirect`), è necessario registrare un gestore di callback usando `handleRedirectCallback(authCallback)` dove `authCallback = function(AuthError, AuthResponse)`. A partire da MSAL 1.3.0 questa procedura è facoltativa. La funzione di callback viene chiamata dopo il completamento corretto o con errore della richiesta di autenticazione. Non è richiesta per i flussi popup perché restituiscono promesse.

```JavaScript
    import * as Msal from "msal";
    // if using cdn version, 'Msal' will be available in the global scope

    const msalConfig = {
        auth: {
            clientId: 'your_client_id'
        }
    };

    const msalInstance = new Msal.UserAgentApplication(msalConfig);

    msalInstance.handleRedirectCallback((error, response) => {
        // handle redirect response or error
    });

```

Per informazioni dettagliate sulle opzioni di configurazione, leggere [Inizializzare le applicazioni client usando MSAL.js](https://docs.microsoft.com/azure/active-directory/develop/msal-js-initializing-client-applications).

#### <a name="2-login-the-user"></a>2. Gestire l'accesso dell'utente

L'app deve concedere l'accesso all'utente con il metodo `loginPopup` o `loginRedirect` per stabilire il contesto utente.

Quando i metodi di accesso vengono chiamati e l'autenticazione dell'utente viene completata dal servizio Azure AD, viene restituito un [token ID](https://docs.microsoft.com/azure/active-directory/develop/id-tokens) usato per identificare l'utente con alcune informazioni di base.

Quando si concede l'accesso a un utente, è possibile passare gli ambiti per i quali l'utente ha fornito preventivamente il consenso per l'accesso, ma non è necessario. Si noti che il consenso per gli ambiti in fase di accesso non restituisce un access_token per questi ambiti, ma consente di ottenere un token con questi ambiti passati, in modo invisibile all'utente.

È consigliabile richiedere solo gli ambiti necessari quando sono necessari, un concetto noto come consenso dinamico. Anche se questo significa un'esperienza di consenso più interattiva per gli utenti nell'applicazione, riduce anche i casi in cui gli utenti si arrendono perché non sono a loro agio con la concessione di un lungo elenco di autorizzazioni per funzionalità che ancora non usano.

AAD consentirà di ottenere il consenso solo per 3 risorse alla volta, anche se è possibile richiedere molti ambiti all'interno di una risorsa.
Quando l'utente effettua una richiesta di accesso, è possibile passare più risorse e i relativi ambiti corrispondenti perché AAD genera un idToken con il pre-consenso per tali ambiti. Tuttavia, le chiamate acquireToken sono valide solo per una risorsa/più ambiti. Se è necessario accedere a più risorse, effettuare chiamate acquireToken separate per ogni risorsa.

```JavaScript
   var loginRequest = {
       scopes: ["user.read", "mail.send"] // optional Array<string>
   };

    msalInstance.loginPopup(loginRequest)
        .then(response => {
            // handle response
        })
        .catch(err => {
            // handle error
        });

```

##### <a name="ssosilent"></a>ssoSilent

Se si è certi che l'utente abbia una sessione esistente e si desidera stabilire il contesto utente senza richiedere l'interazione, è possibile richiamare `ssoSilent` con un `loginHint` o `sid` (disponibile come [attestazione facoltativa](https://docs.microsoft.com/azure/active-directory/develop/active-directory-optional-claims)) e MSAL tenterà di eseguire l'accesso SSO in modo invisibile alla sessione esistente e stabilire il contesto utente.

Nota, se non è presente alcuna sessione attiva per il `loginHint` o `sid` specificato, verrà generato un errore, che deve essere gestito richiamando un metodo di accesso interattivo (`loginPopup` o `loginRedirect`).

Esempio:

```js
const ssoRequest = {
    loginHint: "user@example.com"
};

msalInstance.ssoSilent(ssoRequest)
    .then(response => {
        // session silently established
    })
    .catch(error => {
        // handle error by invoking an interactive login method
        msalInstance.loginPopup(ssoRequest);
    });
```

#### <a name="3-get-an-access-token-to-call-an-api"></a>3. Ottenere un token di accesso per chiamare un'API

In MSAL è possibile ottenere token di accesso per le API che l'app deve chiamare usando il metodo `acquireTokenSilent` che invia una richiesta invisibile all'utente (senza presentare richieste all'utente tramite l'interfaccia utente) ad Azure AD per ottenere un token di accesso. Il servizio Azure AD restituisce quindi un [token di accesso](https://docs.microsoft.com/azure/active-directory/develop/access-tokens) contenente gli ambiti consentiti dall'utente in modo che l'app possa chiamare in modo sicuro l'API.

È possibile usare `acquireTokenRedirect` o `acquireTokenPopup` per avviare richieste interattive, anche se è consigliabile mostrare esperienze interattive solo se non è possibile ottenere un token in modo invisibile a causa di errori necessari per l'interazione. Se si usa una chiamata interattiva per il token, deve corrispondere al metodo di accesso usato nell'applicazione. (`loginPopup`=> `acquireTokenPopup`, `loginRedirect` => `acquireTokenRedirect`).

Se la chiamata `acquireTokenSilent` ha esito negativo con un errore di tipo `InteractionRequiredAuthError`, sarà necessario avviare una richiesta interattiva.  Ciò può verificarsi per molti motivi, inclusi ambiti revocati, token scaduti o modifiche delle password.

`acquireTokenSilent` cercherà un token valido nella cache e, se è prossimo alla scadenza o non esiste, tenterà automaticamente di aggiornarlo.

Per informazioni di riferimento, vedere i [tipi di dati per richieste e risposte](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL.js-1.0.0-api-release#signing-in-and-getting-tokens-with-msaljs).

```JavaScript
    // if the user is already logged in you can acquire a token
    if (msalInstance.getAccount()) {
        var tokenRequest = {
            scopes: ["user.read", "mail.send"]
        };
        msalInstance.acquireTokenSilent(tokenRequest)
            .then(response => {
                // get access token from response
                // response.accessToken
            })
            .catch(err => {
                // could also check if err instance of InteractionRequiredAuthError if you can import the class.
                if (err.name === "InteractionRequiredAuthError") {
                    return msalInstance.acquireTokenPopup(tokenRequest)
                        .then(response => {
                            // get access token from response
                            // response.accessToken
                        })
                        .catch(err => {
                            // handle error
                        });
                }
            });
    } else {
        // user is not logged in, you will need to log them in to acquire a token
    }
```

#### <a name="4-use-the-token-as-a-bearer-in-an-http-request-to-call-the-microsoft-graph-or-a-web-api"></a>4. Usare il token come bearer in una richiesta HTTP per chiamare l'API Microsoft Graph o un'API Web

```JavaScript
    var headers = new Headers();
    var bearer = "Bearer " + token;
    headers.append("Authorization", bearer);
    var options = {
         method: "GET",
         headers: headers
    };
    var graphEndpoint = "https://graph.microsoft.com/v1.0/me";

    fetch(graphEndpoint, options)
        .then(resp => {
             //do something with response
        });
```

È possibile ottenere ulteriori dettagli sulle funzionalità MSAL.js documentate nel [wiki MSAL](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki) e trovare [esempi di codice](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/Samples) completi.

## <a name="security-reporting"></a>Segnalazioni per la sicurezza

Se si riscontra un problema di sicurezza con le librerie o i servizi, segnalarlo a [secure@microsoft.com](mailto:secure@microsoft.com) con il maggior numero possibile di dettagli. Per l'invio potrebbe essere prevista una ricompensa tramite il programma [Microsoft Bounty](http://aka.ms/bugbounty). Non pubblicare problemi di sicurezza in GitHub Issues o altri siti pubblici. Contatteremo l'autore dell'invio poco tempo dopo aver ricevuto le informazioni. È consigliabile ricevere notifiche in caso di problemi di sicurezza. A tale scopo, visitare [questa pagina](https://technet.microsoft.com/security/dd252948) e sottoscrivere gli avvisi di sicurezza.

## <a name="license"></a>Licenza

Copyright (c) Microsoft Corporation.  Tutti i diritti sono riservati. Concesso in licenza secondo i termini della licenza MIT ("Licenza").

## <a name="we-value-and-adhere-to-the-microsoft-open-source-code-of-conduct"></a>Microsoft apprezza e rispetta il codice di comportamento Microsoft per l'open source

Questo progetto ha adottato il [Codice di comportamento di Microsoft per l'open source](https://opensource.microsoft.com/codeofconduct/). Per altre informazioni, vedere [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) (Domande frequenti sul codice di condotta) oppure contattare [opencode@microsoft.com](mailto:opencode@microsoft.com) per eventuali domande o commenti.
