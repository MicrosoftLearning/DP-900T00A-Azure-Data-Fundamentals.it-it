---
ms.openlocfilehash: 7a40bb5c1f9bdc59490cf2a2dbf591d14b488b41
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 02/05/2022
ms.locfileid: "138051371"
---
# <a name="form-data-npm-modulehttpswwwnpmjscompackageform-data-join-the-chat-at-httpsgitterimform-dataform-datahttpsgitterimform-dataform-data"></a>Form-Data [![Modulo NPM](https://img.shields.io/npm/v/form-data.svg)](https://www.npmjs.com/package/form-data) [![Partecipare alla chat su https://gitter.im/form-data/form-data](http://form-data.github.io/images/gitterbadge.svg)](https://gitter.im/form-data/form-data)

Libreria per creare flussi ```"multipart/form-data"``` leggibili. Può essere usato per inviare moduli e caricamenti di file in altre applicazioni Web.

L'API di questa libreria è ispirata all'[interfaccia FormData XMLHttpRequest-2][xhr2-fd].

[xhr2-fd]: http://dev.w3.org/2006/webapi/XMLHttpRequest-2/Overview.html#the-formdata-interface

[![Compilazione per Linux](https://img.shields.io/travis/form-data/form-data/v3.0.1.svg?label=linux:6.x-12.x)](https://travis-ci.org/form-data/form-data)
[![Compilazione per MacOS](https://img.shields.io/travis/form-data/form-data/v3.0.1.svg?label=macos:6.x-12.x)](https://travis-ci.org/form-data/form-data)
[![Compilazione per Windows](https://img.shields.io/travis/form-data/form-data/v3.0.1.svg?label=windows:6.x-12.x)](https://travis-ci.org/form-data/form-data)

[![Stato del code coverage](https://img.shields.io/coveralls/form-data/form-data/v3.0.1.svg?label=code+coverage)](https://coveralls.io/github/form-data/form-data?branch=master)
[![Stato delle dipendenze](https://img.shields.io/david/form-data/form-data.svg)](https://david-dm.org/form-data/form-data)

## <a name="install"></a>Installazione

```
npm install --save form-data
```

## <a name="usage"></a>Utilizzo

In questo esempio viene creato un modulo con 3 campi che contengono una stringa, un buffer e un flusso di file.

``` javascript
var FormData = require('form-data');
var fs = require('fs');

var form = new FormData();
form.append('my_field', 'my value');
form.append('my_buffer', new Buffer(10));
form.append('my_file', fs.createReadStream('/foo/bar.jpg'));
```

È anche possibile usare il flusso http-response:

``` javascript
var FormData = require('form-data');
var http = require('http');

var form = new FormData();

http.request('http://nodejs.org/images/logo.png', function(response) {
  form.append('my_field', 'my value');
  form.append('my_buffer', new Buffer(10));
  form.append('my_logo', response);
});
```

Oppure il flusso [request](https://github.com/request/request) di @mikeal:

``` javascript
var FormData = require('form-data');
var request = require('request');

var form = new FormData();

form.append('my_field', 'my value');
form.append('my_buffer', new Buffer(10));
form.append('my_logo', request('http://nodejs.org/images/logo.png'));
```

Per inviare questo modulo a un'applicazione Web, chiamare il metodo ```submit(url, [callback])```:

``` javascript
form.submit('http://example.org/', function(err, res) {
  // res – response object (http.IncomingMessage)  //
  res.resume();
});

```

Per manipolazioni delle richieste più avanzate, il metodo ```submit()``` restituisce l'oggetto ```http.ClientRequest``` oppure è possibile scegliere uno dei metodi di invio alternativi.

### <a name="custom-options"></a>Opzioni personalizzate

È possibile fornire opzioni personalizzate, ad esempio `maxDataSize`:

``` javascript
var FormData = require('form-data');

var form = new FormData({ maxDataSize: 20971520 });
form.append('my_field', 'my value');
form.append('my_buffer', /* something big */);
```

L'elenco delle opzioni disponibili è disponibile in [combined-stream](https://github.com/felixge/node-combined-stream/blob/master/lib/combined_stream.js#L7-L15)

### <a name="alternative-submission-methods"></a>Metodi di invio alternativi

È possibile usare l'interfaccia client HTTP di Node:

``` javascript
var http = require('http');

var request = http.request({
  method: 'post',
  host: 'example.org',
  path: '/upload',
  headers: form.getHeaders()
});

form.pipe(request);

request.on('response', function(res) {
  console.log(res.statusCode);
});
```

In alternativa, se si preferisce che l'intestazione `'Content-Length'` venga impostata automaticamente:

``` javascript
form.submit('example.org/upload', function(err, res) {
  console.log(res.statusCode);
});
```

Per usare intestazioni personalizzate e una lunghezza prestabilita nelle parti:

``` javascript
var CRLF = '\r\n';
var form = new FormData();

var options = {
  header: CRLF + '--' + form.getBoundary() + CRLF + 'X-Custom-Header: 123' + CRLF + CRLF,
  knownLength: 1
};

form.append('my_buffer', buffer, options);

form.submit('http://example.com/', function(err, res) {
  if (err) throw err;
  console.log('Done');
});
```

Form-Data è in grado di riconoscere e recuperare tutte le informazioni necessarie dai tipi più comuni di flussi (```fs.readStream```, ```http.response``` e ```mikeal's request```). Per alcuni altri tipi di flussi, è necessario fornire manualmente informazioni correlate al "file":

``` javascript
someModule.stream(function(err, stdout, stderr) {
  if (err) throw err;

  var form = new FormData();

  form.append('file', stdout, {
    filename: 'unicycle.jpg', // ... or:
    filepath: 'photos/toys/unicycle.jpg',
    contentType: 'image/jpeg',
    knownLength: 19806
  });

  form.submit('http://example.com/', function(err, res) {
    if (err) throw err;
    console.log('Done');
  });
});
```

La proprietà `filepath` esegue l'override di `filename` e può contenere un percorso relativo. In genere, viene usata durante il caricamento di [più file da una directory](https://wicg.github.io/entries-api/#dom-htmlinputelement-webkitdirectory).

Per i casi limite, ad esempio una richiesta POST all'URL con una stringa di query o per passare le credenziali di autenticazione HTTP, l'oggetto può essere passato a `form.submit()` come primo parametro:

``` javascript
form.submit({
  host: 'example.com',
  path: '/probably.php?extra=params',
  auth: 'username:password'
}, function(err, res) {
  console.log(res.statusCode);
});
```

Nel caso sia necessario inviare anche intestazioni HTTP personalizzate con la richiesta POST, è possibile usare la chiave `headers` nel primo parametro di `form.submit()`:

``` javascript
form.submit({
  host: 'example.com',
  path: '/surelynot.php',
  headers: {'x-test-header': 'test-header-value'}
}, function(err, res) {
  console.log(res.statusCode);
});
```

### <a name="methods"></a>Metodi

- [_Void_ append( **String** _field_, **Mixed** _value_ [, **Mixed** _options_] )](https://github.com/form-data/form-data#void-append-string-field-mixed-value--mixed-options-).
- [_Headers_ getHeaders( [**Headers** _userHeaders_] )](https://github.com/form-data/form-data#array-getheaders-array-userheaders-)
- [_String_ getBoundary()](https://github.com/form-data/form-data#string-getboundary)
- [_Void_ setBoundary()](https://github.com/form-data/form-data#void-setboundary)
- [_Buffer_ getBuffer()](https://github.com/form-data/form-data#buffer-getbuffer)
- [_Integer_ getLengthSync()](https://github.com/form-data/form-data#integer-getlengthsync)
- [_Integer_ getLength( **function** _callback_ )](https://github.com/form-data/form-data#integer-getlength-function-callback-)
- [_Boolean_ hasKnownLength()](https://github.com/form-data/form-data#boolean-hasknownlength)
- [_Request_ submit( _params_, **function** _callback_ )](https://github.com/form-data/form-data#request-submit-params-function-callback-)
- [_String_ toString()](https://github.com/form-data/form-data#string-tostring)

#### <a name="_void_-append-string-_field_-mixed-_value_--mixed-_options_-"></a>_Void_ append( **String** _field_, **Mixed** _value_ [, **Mixed** _options_] )
Accodare dati al modulo. È possibile inviare informazioni su qualsiasi formato (stringa, intero, booleano, buffer e così via). Tuttavia, le matrici non sono supportate e devono essere trasformate in stringhe dall'utente.
```javascript
var form = new FormData();
form.append( 'my_string', 'my value' );
form.append( 'my_integer', 1 );
form.append( 'my_boolean', true );
form.append( 'my_buffer', new Buffer(10) );
form.append( 'my_array_as_json', JSON.stringify( ['bird','cute'] ) )
```

È possibile specificare una stringa per le opzioni oppure un oggetto.
```javascript
// Set filename by providing a string for options
form.append( 'my_file', fs.createReadStream('/foo/bar.jpg'), 'bar.jpg' );

// provide an object.
form.append( 'my_file', fs.createReadStream('/foo/bar.jpg'), {filename: 'bar.jpg', contentType: 'image/jpeg', knownLength: 19806} );
```

#### <a name="_headers_-getheaders-headers-_userheaders_-"></a>_Headers_ getHeaders( [**Headers** _userHeaders_] )
Questo metodo aggiunge l'intestazione `content-type` corretta alla matrice specificata di `userHeaders`.  

#### <a name="_string_-getboundary"></a>_String_ getBoundary()
Restituisce il limite di formData. Per impostazione predefinita, il limite è costituito da 26 `-` seguiti da 24 numeri, ad esempio:
```javascript
--------------------------515890814546601021194782
```

#### <a name="_void_-setboundarystring-_boundary_"></a>_Void_ setBoundary(String _boundary_)
Impostare la stringa di limite, eseguendo l'override del comportamento predefinito descritto in precedenza.

_Nota: il limite deve essere univoco e potrebbe non essere visualizzato nei dati._

#### <a name="_buffer_-getbuffer"></a>_Buffer_ getBuffer()
Restituire il pacchetto di richiesta formdata completo, come buffer. È ad esempio possibile inserire questo buffer in Axios per inviare dati multipart.
```javascript
var form = new FormData();
form.append( 'my_buffer', Buffer.from([0x4a,0x42,0x20,0x52,0x6f,0x63,0x6b,0x73]) );
form.append( 'my_file', fs.readFileSync('/foo/bar.jpg') );

axios.post( 'https://example.com/path/to/api',
            form.getBuffer(),
            form.getHeaders()
          )
```
**Nota:** Poiché l'output è di tipo Buffer, è possibile accodare solo i tipi accettati da Buffer: *string, Buffer, ArrayBuffer, Array o Array-like Object*. Un valore ReadStream, ad esempio, genera un errore.

#### <a name="_integer_-getlengthsync"></a>_Integer_ getLengthSync()
Come `getLength` ma sincrono.

_Nota: getLengthSync __non__ calcola la lunghezza dei flussi._

#### <a name="_integer_-getlength-function-_callback_-"></a>_Integer_ getLength( **function** _callback_ )
Restituisce il valore asincrono `Content-Length`. Il callback viene usato per gestire gli errori e continuare una volta calcolata la lunghezza
```javascript
this.getLength(function(err, length) {
  if (err) {
    this._error(err);
    return;
  }

  // add content length
  request.setHeader('Content-Length', length);

  ...
}.bind(this));
```

#### <a name="_boolean_-hasknownlength"></a>_Boolean_ hasKnownLength()
Verifica se la lunghezza dei valori aggiunti è nota.

#### <a name="_request_-submit-_params_-function-_callback_-"></a>_Request_ submit( _params_, **function** _callback_ )
Inviare il modulo a un'applicazione Web.
```javascript
var form = new FormData();
form.append( 'my_string', 'Hello World' );

form.submit( 'http://example.com/', function(err, res) {
  // res – response object (http.IncomingMessage)  //
  res.resume();
} );
```

#### <a name="_string_-tostring"></a>_String_ toString()
Restituisce i dati del modulo come stringa. Non usare questa opzione se si inviano file o buffer. Usare invece `getBuffer()`.

### <a name="integration-with-other-libraries"></a>Integrazione con altre librerie

#### <a name="request"></a>Richiesta

Invio di moduli tramite [request](https://github.com/request/request):

```javascript
var formData = {
  my_field: 'my_value',
  my_file: fs.createReadStream(__dirname + '/unicycle.jpg'),
};

request.post({url:'http://service.com/upload', formData: formData}, function(err, httpResponse, body) {
  if (err) {
    return console.error('upload failed:', err);
  }
  console.log('Upload successful!  Server responded with:', body);
});
```

Per altre informazioni, vedere il [file Leggimi di request](https://github.com/request/request#multipartform-data-multipart-form-uploads).

#### <a name="node-fetch"></a>node-fetch

È anche possibile inviare un modulo usando [node-fetch](https://github.com/bitinn/node-fetch):

```javascript
var form = new FormData();

form.append('a', 1);

fetch('http://example.com', { method: 'POST', body: form })
    .then(function(res) {
        return res.json();
    }).then(function(json) {
        console.log(json);
    });
```

#### <a name="axios"></a>axios

In Node.js è possibile pubblicare un file usando [axios](https://github.com/axios/axios):
```javascript
const form = new FormData();
const stream = fs.createReadStream(PATH_TO_FILE);

form.append('image', stream);

// In Node.js environment you need to set boundary in the header field 'Content-Type' by calling method `getHeaders`
const formHeaders = form.getHeaders();

axios.post('http://example.com', form, {
  headers: {
    ...formHeaders,
  },
})
.then(response => response)
.catch(error => error)
```

## <a name="notes"></a>Note

- Il metodo ```getLengthSync()``` NON calcola la lunghezza dei flussi. Usare le opzioni ```knownLength``` come soluzione alternativa.
- A partire dalla versione `2.x`, FormData ha interrotto il supporto per `node@0.10.x`.
- A partire dalla versione `3.x`, FormData ha interrotto il supporto per `node@4.x`.

## <a name="license"></a>Licenza

Form-Data è rilasciato con licenza [MIT](License).
