---
ms.openlocfilehash: ca1f677bd38876befee833fcedd10388a71aecf4
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 02/05/2022
ms.locfileid: "138053108"
---
<a name="agent-base"></a>agent-base
==========
### <a name="turn-a-function-into-an-httpagenthttpagent-instance"></a>Trasformare una funzione in un'istanza di [`http.Agent`][http.Agent]
[![Stato della compilazione](https://github.com/TooTallNate/node-agent-base/workflows/Node%20CI/badge.svg)](https://github.com/TooTallNate/node-agent-base/actions?workflow=Node+CI)

Questo modulo fornisce un generatore di `http.Agent`, vale a dire che, passandogli una funzione di callback asincrona, restituisce una nuova istanza di `http.Agent` che richiamerà la funzione di callback specificata quando si invieranno richieste HTTP in uscita.

#### <a name="some-subclasses"></a>Alcune sottoclassi:

Ecco alcuni usi più interessanti di `agent-base`.
Inviare una richiesta pull per inserire i propri nell'elenco.

 * [`http-proxy-agent`][http-proxy-agent]: Implementazione di `http.Agent` del proxy HTTP(S) per gli endpoint HTTP
 * [`https-proxy-agent`][https-proxy-agent]: Implementazione di `http.Agent` del proxy HTTP(S) per gli endpoint HTTPS
 * [`pac-proxy-agent`][pac-proxy-agent]: Implementazione di `http.Agent` del proxy file PAC per HTTP e HTTPS
 * [`socks-proxy-agent`][socks-proxy-agent]: Implementazione di `http.Agent` del proxy SOCKS per HTTP e HTTPS


<a name="installation"></a>Installazione
------------

Installare con `npm`:

``` bash
$ npm install agent-base
```


<a name="example"></a>Esempio
-------

Ecco un esempio minimo che crea una nuova connessione `net.Socket` al server per ogni richiesta HTTP (ad esempio, l'equivalente dell'opzione `agent: false`):

```js
var net = require('net');
var tls = require('tls');
var url = require('url');
var http = require('http');
var agent = require('agent-base');

var endpoint = 'http://nodejs.org/api/';
var parsed = url.parse(endpoint);

// This is the important part!
parsed.agent = agent(function (req, opts) {
  var socket;
  // `secureEndpoint` is true when using the https module
  if (opts.secureEndpoint) {
    socket = tls.connect(opts);
  } else {
    socket = net.connect(opts);
  }
  return socket;
});

// Everything else works just like normal...
http.get(parsed, function (res) {
  console.log('"response" event!', res.headers);
  res.pipe(process.stdout);
});
```

È supportata anche la restituzione di una promessa o l'uso di una funzione `async`:

```js
agent(async function (req, opts) {
  await sleep(1000);
  // etc…
});
```

Restituire un'altra istanza di `http.Agent` per "passare" la responsabilità della richiesta HTTP a tale agente:

```js
agent(function (req, opts) {
  return opts.secureEndpoint ? https.globalAgent : http.globalAgent;
});
```


<a name="api"></a>API
---

## <a name="agentfunction-callback-object-options--httpagent"></a>Agent(Function callback[, Object options]) → [http.Agent][]

Crea un oggetto `http.Agent` di base che eseguirà la funzione di callback `callback` per ogni richiesta HTTP per cui viene usato come `agent`. La funzione di callback è responsabile della creazione di un'istanza di `stream.Duplex` di qualche tipo, che verrà usata come socket sottostante nella richiesta HTTP.

L'oggetto `options` accetta le proprietà seguenti:

  * `timeout` - Numero - Timeout per la funzione `callback()` in millisecondi. Il valore predefinito è Infinity (facoltativo).

La funzione di callback deve avere la firma seguente:

### <a name="callbackhttpclientrequest-req-object-options-function-cb--undefined"></a>callback(http.ClientRequest req, Object options, Function cb) → undefined

È possibile accedere a ClientRequest `req` per leggere le intestazioni della richiesta, il percorso e così via. L'oggetto `options` contiene le opzioni passate alla chiamata di funzione `http.request()`/`https.request()` ed è formattato per essere passato direttamente a `net.connect()`/`tls.connect()` o in qualsiasi altro modo si voglia creare un socket. Una volta creato il socket, passarlo funzione di callback `cb` e la richiesta HTTP continuerà a procedere.

Se viene usato il modulo `https` per richiamare la richiesta HTTP, la proprietà `secureEndpoint` in `options` _verrà impostata su `true`_ .


<a name="license"></a>Licenza
-------

(Licenza MIT)

Copyright (c) 2013 Nathan Rajlich &lt;nathan@tootallnate.net&gt;

Questo documento concede l'autorizzazione, a titolo gratuito, a chiunque ottenga una copia di questo software e dei file della documentazione (il "Software"), di utilizzare il Software senza restrizioni, inclusi a titolo non esaustivo i diritti di utilizzo, copia, modifica, fusione, pubblicazione, distribuzione, concessione in sublicenza e/o vendita di copie del Software, e di consentire alle persone a cui è fornito il Software di eseguire queste azioni, fatte salve le seguenti condizioni:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

IL SOFTWARE VIENE FORNITO "COSÌ COM'È", SENZA ALCUNA GARANZIA, ESPRESSA O IMPLICITA, INCLUSE, A TITOLO ESEMPLIFICATIVO, LE GARANZIE DI COMMERCIABILITÀ, IDONEITÀ PER UNO SCOPO SPECIFICO E NON VIOLAZIONE DEI DIRITTI ALTRUI.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

[http-proxy-agent]: https://github.com/TooTallNate/node-http-proxy-agent
[https-proxy-agent]: https://github.com/TooTallNate/node-https-proxy-agent
[pac-proxy-agent]: https://github.com/TooTallNate/node-pac-proxy-agent
[socks-proxy-agent]: https://github.com/TooTallNate/node-socks-proxy-agent
[http.Agent]: https://nodejs.org/api/http.html#http_class_http_agent
