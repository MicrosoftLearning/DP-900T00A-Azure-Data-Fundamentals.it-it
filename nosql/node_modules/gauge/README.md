---
ms.openlocfilehash: 81fd1455668c9343defe69cbbbff10d48b1f97ef
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 02/05/2022
ms.locfileid: "138051915"
---
<a name="gauge"></a>misuratore
=====

Un terminale quasi senza stato basato su misuratore/indicatore di stato orizzontale.

```javascript
var Gauge = require("gauge")

var gauge = new Gauge()

gauge.show("test", 0.20)

gauge.pulse("this")

gauge.hide()
```

![](gauge-demo.gif)


### <a name="changes-from-1x"></a>MODIFICHE DALLA VERSIONE 1.x

Gauge 2.x è una nuova versione. Se si usava questo modulo in precedenza, vedere [changelog] per informazioni dettagliate sulle modifiche apportate.

[log delle modifiche]: CHANGELOG.md

### <a name="the-gauge-class"></a>CLASSE GAUGE

Si tratta dell'interfaccia tipica del modulo: fornisce un'interfaccia di tipo "fire and forget" per visualizzare le informazioni sullo stato.

```
var Gauge = require("gauge")

var gauge = new Gauge([stream], [options])
```

* **stream** *: (facoltativo, valore predefinito: STDERR)* flusso in cui devono essere scritti gli aggiornamenti della barra di stato.  Gauge rispetta la contropressione e sospende la maggior parte della scrittura se è specificato.
* **options**: *(facoltativo)* oggetto opzione.

Costruisce un nuovo misuratore. I misuratori vengono disegnati su una singola riga e non vengono disegnati se **stream** non è un TTY e non viene specificato in modo esplicito un TTY.

Se **stream** è un terminale o se si passa **tty** a **options**, verrà rilevato il ridimensionamento del terminale e il misuratore sarà ridisegnato per adattarlo.  Questa operazione viene eseguita controllando gli eventi `resize` sul TTY.  Per ovviare a un bug nelle versioni di Node precedenti alla 2.5.0, vengono controllati in stdout se il TTY è stderr. I ridimensionamenti a finestre di maggiori dimensioni saranno puliti, ma il rimpicciolimento della finestra comporterà sempre qualche problema.

**IMPORTANTE:** se in precedenza veniva passato un flusso non TTY, ma si desidera comunque l'output (ad esempio, un flusso incapsulato dal modulo `ansi`), è necessario passare l'opzione **tty** seguente, in quanto `gauge` deve accedere al TTY sottostante per eseguire operazioni come i ridimensionamenti del terminale e il rilevamento della larghezza del terminale.

L'oggetto **options** può avere le proprietà seguenti, tutte facoltative:

* **updateInterval**: frequenza con cui devono essere disegnati gli aggiornamenti dell'indicatore, in millisecondi.
* **fixedFramerate**: il valore predefinito è false in Node 0.8, true in tutte le altre versioni.  Quando è impostato su true, viene creato un timer da attivare una volta ogni `updateInterval` ms. Quando è impostato su false, gli aggiornamenti sono stampati non appena vengono ricevuti, ma gli aggiornamenti con una frequenza superiore a `updateInterval` vengono ignorati.  Il motivo per cui nella versione 0.8 questa opzione non è impostata su true è che non è possibile usare `unref` per il relativo timer, cosa che impedirebbe la chiusura del programma. Per usare questa funzionalità con la versione 0.8, assicurarsi di chiamare `gauge.disable()` prima di chiudere il programma.
* **themes**: set di temi da usare quando si seleziona il tema da utilizzare. Il valore predefinito è `gauge/themes`. Per informazioni dettagliate, vedere la documentazione di [themes].
* **theme**: Selezionare un tema da usare. Può essere:
  * Un oggetto theme, nel qual caso **themes** non viene usato.
  * Il nome di un tema, che verrà cercato nell'oggetto *themes* corrente.
  * Un oggetto di configurazione con la chiave `hasUnicode`, `hasColor` o `platform`, che verrà usato per eseguire l'override dei valori consigliati durante la selezione di un tema predefinito.

  Se non viene selezionato alcun tema, viene scelto un valore predefinito usando una combinazione dei valori consigliati rispetto al sistema operativo, al supporto del colore e al supporto per Unicode.
* **template**: descrive l'aspetto che deve avere il misuratore.  Il valore predefinito è quello usato da npm.  La [documentazione] dettagliata è disponibile più avanti in questo documento.
* **hideCursor**: il valore predefinito è true.  Se true, il cursore verrà nascosto mentre viene visualizzato il misuratore.
* **tty**: il TTY in cui si esegue la scrittura.  Il valore predefinito è uguale a quello di **stream**.  Viene usato per rilevare la larghezza del terminale ed eseguire il ridimensionamento. La larghezza usata è `tty.columns - 1`. Se non è disponibile alcun TTY, viene presupposta una larghezza di `79`.
* **enabled**: il valore predefinito è true se `tty` è un TTY. In caso contrario, è false.  Se true, il misuratore è abilitato all'avvio.  Se disabilitato, tutti i comandi di aggiornamento vengono ignorati e non verrà stampato alcun misuratore finché non si chiama `.enable()`.
* **Plumbing**: la classe da usare per generare effettivamente il misuratore per la stampa.  Il valore predefinito è `require('gauge/plumbing')` e normalmente non è necessario eseguirne l'override.
* **cleanupOnExit**: il valore predefinito è true. In genere viene registrato un gestore di uscita per assicurarsi che il cursore venga riattivato e che la barra di avanzamento venga cancellata alla chiusura del processo, anche se si esce premendo CTRL+C o in modo imprevisto per altri motivi. È possibile disabilitarlo per non registrare il gestore di uscita.

[has-unicode]: https://www.npmjs.com/package/has-unicode
[themes]: #themes
[documentazione]: #templates.

#### `gauge.show(section | status, [completed])`

Il primo argomento è la sezione, il nome dell'elemento corrente che contribuisce allo stato di avanzamento o un oggetto con chiavi come **section**, **subsection** e **completed** (o altre chiavi per cui sono presenti tipi in un modello personalizzato).  Se non si vuole aggiornare o impostare alcuno di questi elementi, è possibile passare `null` e verrà ignorato.

Il secondo argomento è la percentuale completata come valore compreso tra 0 e 1.
Senza di esso, il completamento non viene aggiornato. Si noti anche che il completamento può essere passato come parte di un oggetto status come primo argomento. Se vengono passati sia questo che l'argomento completed, l'argomento completed ha la precedenza.

#### `gauge.hide([cb])`

Rimuove il misuratore dal terminale.  Facoltativamente, eseguire il callback di `cb` dopo che si sono verificate attività di I/O (attualmente questo significa solo dopo il callback di `setImmediate`).

Ciò risulta importante quando si sospende l'indicatore di stato su un handle di file e si esegue la stampa su un altro. In caso contrario, con una stampa abbastanza grande, Node può stampare i bit dell'"indicatore di stato finale" nell'handle di file dell'indicatore di stato, mentre altri elementi vengono stampati in un altro handle di file. L'interlacciamento di tali elementi può causare problemi in alcuni terminali.

#### `gauge.pulse([subsection])`

* **subsection**: *(facoltativo)* l'elemento specifico che ha attivato questo impulso

Ruota la rotellina nel misuratore per visualizzare l'output.  Se **subsection** è incluso, verrà combinato con l'ultimo nome passato a `gauge.show`.

#### `gauge.disable()`

Nasconde il misuratore e ignora ulteriori chiamate a `show` o `pulse`.

#### `gauge.enable()`

Mostra il misuratore e riprende l'aggiornamento quando viene chiamato `show` o `pulse`.

#### `gauge.isEnabled()`

Restituisce true se il misuratore è abilitato.

#### `gauge.setThemeset(themes)`

Modificare il set di temi da cui selezionare un tema. Uguale all'opzione `themes` usata nel costruttore. Il tema verrà riselezionato da questo set di temi.

#### `gauge.setTheme(theme)`

Modificare il tema attivo. Verrà mostrato con la successiva visualizzazione o il successivo impulso. Può trattarsi di:

* Un oggetto theme, nel qual caso **themes** non viene usato.
* Il nome di un tema, che verrà cercato nell'oggetto *themes* corrente.
* Un oggetto di configurazione con la chiave `hasUnicode`, `hasColor` o `platform`, che verrà usato per eseguire l'override dei valori consigliati durante la selezione di un tema predefinito.

Se non viene selezionato alcun tema, viene scelto un valore predefinito usando una combinazione dei valori consigliati rispetto al sistema operativo, al supporto del colore e al supporto per Unicode.

#### `gauge.setTemplate(template)`

Modificare il modello attivo. Verrà mostrato con la successiva visualizzazione o il successivo impulso.

### <a name="tracking-completion"></a>Completamento del rilevamento

Se si vuole tenere traccia del completamento di più elementi, potrebbe essere utile l'oggetto correlato [are-we-there-yet].  Il relativo evento `change` può essere associato al metodo `show` per ottenere un'interfaccia dell'indicatore di stato più tradizionale.

[are-we-there-yet]: https://www.npmjs.com/package/are-we-there-yet

### <a name="themes"></a>THEMES

```
var themes = require('gauge/themes')

// fetch the default color unicode theme for this platform
var ourTheme = themes({hasUnicode: true, hasColor: true})

// fetch the default non-color unicode theme for osx
var ourTheme = themes({hasUnicode: true, hasColor: false, platform: 'darwin'})

// create a new theme based on the color ascii theme for this platform
// that brackets the progress bar with arrows
var ourTheme = themes.newTheme(theme(hasUnicode: false, hasColor: true}), {
  preProgressbar: '→',
  postProgressbar: '←'
})
```

L'oggetto restituito da `gauge/themes` è un'istanza della classe `ThemeSet`.

```
var ThemeSet = require('gauge/theme-set')
var themes = new ThemeSet()
// or
var themes = require('gauge/themes')
var mythemes = themes.newThemeset() // creates a new themeset based on the default themes
```

#### <a name="themesopts"></a>themes(opts)
#### <a name="themesgetdefaultopts"></a>themes.getDefault(opts)

Gli oggetti theme sono una funzione che recupera il tema predefinito in base al supporto per la piattaforma, Unicode e il colore.

Options è un oggetto con le proprietà seguenti:

* **hasUnicode**: se true, recuperare un tema Unicode. Se non è disponibile alcun tema Unicode, verrà usato un tema non Unicode.
* **hasColor**: se true, recuperare un tema a colori. Se non è disponibile alcun tema a colori, verrà usato un tema non a colori.
* **platform** (facoltativo): il valore predefinito è `process.platform`.  Se non è disponibile alcuna corrispondenza per la piattaforma, viene invece usato `fallback`.

Se non è possibile trovare un tema compatibile, verrà generato un errore con un elemento `code` di `EMISSINGTHEME`.

#### <a name="themesaddthemethemename-themeobj"></a>themes.addTheme(themeName, themeObj)
#### <a name="themesaddthemethemename-parenttheme-newtheme"></a>themes.addTheme(themeName, [parentTheme], newTheme)

Aggiunge un tema denominato al set di temi.  È possibile passare un oggetto theme, come restituito da `themes.newTheme` o dagli argomenti passati a `themes.newTheme`.

#### <a name="themesgetthemenames"></a>themes.getThemeNames()

Restituisce un elenco di tutti i nomi dei temi in questo set di temi. Adatto per l'uso in `themes.getTheme(…)`.

#### <a name="themesgetthemename"></a>themes.getTheme(name)

Restituisce l'oggetto theme da questo set di temi denominato `name`.

Se `name` non esiste in questo set di temi, verrà generato un errore con un elemento `code` di `EMISSINGTHEME`.

#### <a name="themessetdefaultopts-themename"></a>themes.setDefault([opts], themeName)

`opts` è un oggetto con le proprietà seguenti.

* **platform**: il valore predefinito è `'fallback'`.  Se il tema è specifico della piattaforma, specificare qui tale piattaforma da `process.platform`, ad esempio `win32`, `darwin` e così via.
* **hasUnicode**: il valore predefinito è `false`. Se il tema usa Unicode, è consigliabile impostare questo elemento su true.
* **hasColor**: il valore predefinito è `false`.  Se il tema usa il colore, è consigliabile impostare questo elemento su true.

`themeName` è il nome del tema (come specificato per `addTheme`) da usare per questo set di `opts`.

#### <a name="themesnewthemeparenttheme-newtheme"></a>themes.newTheme([parentTheme,] newTheme)

Creare un nuovo oggetto theme basato su `parentTheme`.  Se non viene specificato `parentTheme`, verrà definito un elemento parentTheme minimo che definisce le funzioni per il rendering dell'indicatore di attività (rotellina) e l'indicatore di stato. Questo elemento padre di fallback è definito in `gauge/base-theme`.

newTheme deve essere un oggetto bare. Si inizierà esaminando le proprietà definite dai temi predefiniti:

* **preProgressbar**: visualizzato prima dell'indicatore di stato, se viene mostrato l'indicatore di stato.
* **postProgressbar**: visualizzato dopo l'indicatore di stato, se viene mostrato l'indicatore di stato.
* **progressBarTheme**: il tema secondario passato al renderer dell'indicatore di stato. È un oggetto con le proprietà `complete` e `remaining` che sono le stringhe che si vuole ripetere per tali sezioni dell'indicatore di stato.
* **activityIndicatorTheme**: il tema dell'indicatore di attività (rotellina). Può essere una stringa, in cui ogni carattere è un passaggio diverso, o una matrice di stringhe.
* **preSubsection**: visualizzato come separatore tra `section` e `subsection` quando quest'ultimo viene stampato.

Più in generale, i temi possono avere qualsiasi valore che sarebbe valido durante il rendering dei modelli. Le proprietà nel tema vengono usate quando il nome corrisponde a un tipo nel modello. I relativi valori possono essere:

* **strings & numbers**: verranno inclusi così come sono.
* **function (values, theme, width)** : deve restituire l'elemento desiderato nell'output.
  *values* è un oggetto con valori forniti tramite `gauge.show`, *theme* è il tema specifico di questo elemento (vedere di seguito) o questo oggetto theme e *width* è il numero di caratteri per la larghezza del risultato.

Esistono alcuni prefissi speciali:

* **pre**: viene mostrato prima della proprietà, se visualizzata.
* **post**: viene mostrato dopo la proprietà, se visualizzata.

E un suffisso speciale:

* **Theme**: il relativo valore viene passato a un elemento di tipo funzione come tema.

#### <a name="themesaddtoallthemestheme"></a>themes.addToAllThemes(theme)

*Inserisce* `theme` in tutti i temi attualmente definiti. Lo aggiunge anche al tema padre predefinito per questo set di temi, quindi i temi che verranno aggiunti successivamente a questo set di temi otterranno i valori da `theme` per impostazione predefinita.

#### <a name="themesnewthemeset"></a>themes.newThemeset()

Copiare il set di temi corrente in uno nuovo.  Ciò consente di ereditare facilmente un set di temi da un altro.

### <a name="templates"></a>TEMPLATES

Un modello è una matrice di oggetti e stringhe che, dopo essere stata valutata, verrà trasformata nella linea del misuratore.  Il modello predefinito è:

```javascript
[
    {type: 'progressbar', length: 20},
    {type: 'activityIndicator', kerning: 1, length: 1},
    {type: 'section', kerning: 1, default: ''},
    {type: 'subsection', kerning: 1, default: ''}
]
```

I vari elementi del modello possono essere **stringhe semplici**, nel qual caso verranno inclusi letteralmente nell'output, oppure oggetti con le proprietà seguenti:

* *type* può essere uno degli elementi seguenti, più eventuali chiavi passate in `gauge.show`, più eventuali chiavi presenti in un tema personalizzato.
  * `section`: l'elemento su cui si sta lavorando al momento.
  * `subsection`: il componente dell'elemento attualmente in esecuzione.
  * `activityIndicator`: mostra una rotellina usando `activityIndicatorTheme` dal tema attivo.
  * `progressbar`: indicatore di stato che rappresenta l'oggetto `completed` corrente usando `progressbarTheme` dal tema attivo.
* *kerning*: numero di spazi che devono essere presenti tra questo elemento e altri elementi, se questo elemento viene visualizzato.
* *maxLength*: lunghezza massima per questo elemento. Se il valore è più lungo, verrà troncato.
* *minLength*: lunghezza minima per questo elemento. Se il valore è più breve, verrà riempito in base al valore di *align*.
* *align*: (impostazione predefinita: left) valori possibili "left", "right" e "center". Funziona come negli elaboratori di testo.
* *length*: fornisce un singolo valore per *minLength* e *maxLength*. Se vengono specificati sia *length* che *minLength o *maxLength*, questi ultimi hanno la precedenza.
* *value*: valore letterale da usare per questo elemento del modello.
* *default*: valore predefinito da usare per questo elemento del modello se non è stato passato un valore in altro modo.

### <a name="plumbing"></a>PLUMBING

Questo è il sistema estremamente semplice usato dal misuratore per implementare la propria interfaccia comune.

```
var Plumbing = require('gauge/plumbing')
var gauge = new Plumbing(theme, template, width)
```

* **theme**: il tema da usare.
* **template**: il modello da usare.
* **width**: la larghezza del misuratore

#### `gauge.setTheme(theme)`

Modificare il tema attivo.

#### `gauge.setTemplate(template)`

Modificare il modello attivo.

#### `gauge.setWidth(width)`

Modificare la larghezza con cui eseguire il rendering.

#### `gauge.hide()`

Restituire la stringa necessaria per nascondere l'indicatore di stato

#### `gauge.hideCursor()`

Restituire una stringa per nascondere il cursore.

#### `gauge.showCursor()`

Restituire una stringa per mostrare il cursore.

#### `gauge.show(status)`

Usando `status` per i valori, eseguire il rendering del modello fornito con il tema e restituire una stringa adatta per la stampa per aggiornare il misuratore.
