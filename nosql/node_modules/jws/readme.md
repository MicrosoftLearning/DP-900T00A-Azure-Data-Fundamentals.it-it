---
ms.openlocfilehash: 4d20fe9ebd12ad861676f14f1c8e66479fd1e481
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 02/05/2022
ms.locfileid: "138051115"
---
# <a name="node-jws-build-statushttptravis-ciorgbrianloveswordsnode-jws"></a>node-jws [![Stato della compilazione](https://secure.travis-ci.org/brianloveswords/node-jws.svg)](http://travis-ci.org/brianloveswords/node-jws)

Implementazione di [JSON Web Signature](http://self-issued.info/docs/draft-ietf-jose-json-web-signature.html).

È stata sviluppata in base a `draft-ietf-jose-json-web-signature-08` e implementa l'intera specifica, **ad eccezione** della firma/verifica della catena di certificati X.509 (patch accettate).

Sono presenti sia API sincrone (`jws.sign`, `jws.verify`) che API di streaming (`jws.createSign`, `jws.createVerify`).

# <a name="install"></a>Installazione

```bash
$ npm install jws
```

# <a name="usage"></a>Utilizzo

## <a name="jwsalgorithms"></a>jws.ALGORITHMS

Matrice di algoritmi supportati. Sono attualmente supportati gli algoritmi seguenti.

Valore del parametro alg | Firma digitale o algoritmo MAC
----------------|----------------------------
HS256 | HMAC che usa l'algoritmo hash SHA-256
HS384 | HMAC che usa l'algoritmo hash SHA-384
HS512 | HMAC che usa l'algoritmo hash SHA-512
RS256 | RSASSA che usa l'algoritmo hash SHA-256
RS384 | RSASSA che usa l'algoritmo hash SHA-384
RS512 | RSASSA che usa l'algoritmo hash SHA-512
PS256 | RSASSA-PSS che usa l'algoritmo hash SHA-256
PS384 | RSASSA-PSS che usa l'algoritmo hash SHA-384
PS512 | RSASSA-PSS che usa l'algoritmo hash SHA-512
ES256 | ECDSA che usa la curva P-256 e l'algoritmo hash SHA-256
ES384 | ECDSA che usa la curva P-384 e l'algoritmo hash SHA-384
ES512 | ECDSA che usa la curva P-521 e l'algoritmo hash SHA-512
Nessuno | Nessuna firma digitale o valore MAC incluso

## <a name="jwssignoptions"></a>jws.sign(options)

(Sincrono) Restituisce una JSON Web Signature per un'intestazione e un payload.

Opzioni:

* `header`
* `payload`
* `secret` o `privateKey`
* `encoding` (facoltativo, il valore predefinito è 'utf8')

`header` deve essere un oggetto con una proprietà `alg`. `header.alg` deve essere un valore trovato in `jws.ALGORITHMS`. Per una tabella di algoritmi supportati, vedere sopra.

Se `payload` non è un buffer o una stringa, viene forzato in una stringa usando `JSON.stringify`.

Esempio

```js
const signature = jws.sign({
  header: { alg: 'HS256' },
  payload: 'h. jon benjamin',
  secret: 'has a van',
});
```

## <a name="jwsverifysignature-algorithm-secretorkey"></a>jws.verify(signature, algorithm, secretOrKey)

(Sincrono) Restituisce `true` o `false` se una firma corrisponde a un segreto o a una chiave.

`signature` è una firma JWS. `header.alg` deve essere un valore trovato in `jws.ALGORITHMS`.
Per una tabella di algoritmi supportati, vedere sopra. `secretOrKey` è una stringa o un buffer contenente il segreto per gli algoritmi HMAC o la chiave pubblica con codifica PEM per gli algoritmi RSA e ECDSA.

Si noti che il valore `"alg"` dell'intestazione della firma viene ignorato.


## <a name="jwsdecodesignature"></a>jws.decode(signature)

(Sincrono) Restituisce l'intestazione decodificata, il payload decodificato e le parti di firma della firma JWS.

Restituisce un oggetto con tre proprietà, ad esempio
```js
{ header: { alg: 'HS256' },
  payload: 'h. jon benjamin',
  signature: 'YOWPewyGHKu4Y_0M_vtlEnNlqmFOclqp4Hy6hVHfFT4'
}
```

## <a name="jwscreatesignoptions"></a>jws.createSign(options)

Restituisce un nuovo oggetto SignStream.

Opzioni:

* `header` (obbligatorio)
* `payload`
* `key` || `privateKey` || `secret`
* `encoding` (facoltativo, il valore predefinito è 'utf8')

Oltre a `header`, tutte le opzioni prevedono una stringa o un buffer quando il valore è noto in anticipo o, per praticità, è un flusso.
`key`/`privateKey`/`secret` può anche essere un oggetto quando si usa una chiave privata crittografata, vedere la [documentazione relativa alla crittografia][encrypted-key-docs].

Esempio:

```js

// This...
jws.createSign({
  header: { alg: 'RS256' },
  privateKey: privateKeyStream,
  payload: payloadStream,
}).on('done', function(signature) {
  // ...
});

// is equivalent to this:
const signer = jws.createSign({
  header: { alg: 'RS256' },
});
privateKeyStream.pipe(signer.privateKey);
payloadStream.pipe(signer.payload);
signer.on('done', function(signature) {
  // ...
});
```

## <a name="jwscreateverifyoptions"></a>jws.createVerify(options)

Restituisce un nuovo oggetto VerifyStream.

Opzioni:

* `signature`
* `algorithm`
* `key` || `publicKey` || `secret`
* `encoding` (facoltativo, il valore predefinito è 'utf8')

Tutte le opzioni prevedono una stringa o un buffer quando il valore è noto in anticipo o, per praticità, è un flusso.

Esempio:

```js

// This...
jws.createVerify({
  publicKey: pubKeyStream,
  signature: sigStream,
}).on('done', function(verified, obj) {
  // ...
});

// is equivilant to this:
const verifier = jws.createVerify();
pubKeyStream.pipe(verifier.publicKey);
sigStream.pipe(verifier.signature);
verifier.on('done', function(verified, obj) {
  // ...
});
```

## <a name="class-signstream"></a>Classe: SignStream

Oggetto `Readable Stream` che crea un singolo evento dati (la firma calcolata) al termine.

### <a name="event-done"></a>Evento: 'done'
`function (signature) { }`

### <a name="signerpayload"></a>signer.payload

Oggetto `Writable Stream` che prevede il payload JWS. *Non* usare se è stata passata un'opzione `payload` al costruttore.

Esempio:

```js
payloadStream.pipe(signer.payload);
```

### <a name="signersecretbrsignerkeybrsignerprivatekey"></a>signer.secret<br>signer.key<br>signer.privateKey

Oggetto `Writable Stream`. Prevede il segreto JWS per l'algoritmo HMAC o la chiave privata per gli algoritmi ECDSA e RSA. *Non* usare se è stata passata un'opzione `secret` o `key` al costruttore.

Esempio:

```js
privateKeyStream.pipe(signer.privateKey);
```

## <a name="class-verifystream"></a>Classe: VerifyStream

Oggetto `Readable Stream` che crea un singolo evento dati per il risultato relativo alla validità o meno della firma.

### <a name="event-done"></a>Evento: 'done'
`function (valid, obj) { }`

`valid` è un valore booleano relativo alla validità o meno della firma.

### <a name="verifiersignature"></a>verifier.signature

Oggetto `Writable Stream` che prevede una firma JWS. *Non* usare se è stata passata un'opzione `signature` al costruttore.

### <a name="verifiersecretbrverifierkeybrverifierpublickey"></a>verifier.secret<br>verifier.key<br>verifier.publicKey

Oggetto `Writable Stream` che prevede una chiave pubblica o un segreto. *Non* usare se è stata passata un'opzione `key` o `secret` al costruttore.

# <a name="todo"></a>TODO

* Dovrebbero essere disponibili API/opzioni pratiche per definire l'algoritmo anziché dover definire ogni volta un oggetto intestazione con `{ alg: 'ES512' }` e così via.

* Supporto X.509.

# <a name="license"></a>Licenza

MIT

```
Copyright (c) 2013-2015 Brian J. Brennan

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
```

[encrypted-key-docs]: https://nodejs.org/api/crypto.html#crypto_sign_sign_private_key_output_format
